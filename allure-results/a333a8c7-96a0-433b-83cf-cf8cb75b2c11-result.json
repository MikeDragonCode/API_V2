{"name": "test_update_visit", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка! Статус визита не изменился!\nassert 'REPORTED' == 'COMPLETE'\n  \n  - COMPLETE\n  + REPORTED", "trace": "get_tokens = ('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJ0ZXN0QHRlc3QucnUiLCJpYXQiOjE3NDEyNzM1MzUsImV4cCI6MTc3Mjg...1haWwiOiJ0ZXN0QHRlc3QucnUiLCJpYXQiOjE3NDEyNzM1MzUsImV4cCI6MTc0MTMwMjMzNX0.GOO8ljCmAvz0o3JBwfKHTaOR61jS1rGXPWpuzR1P83o')\nvisit_id_storage = {'visit_id': 533461}\n\n    def test_update_visit(get_tokens, visit_id_storage):\n        \"\"\"Обновление визита до COMPLETED\"\"\"\n        access_token, refresh_token = get_tokens  # Берем токены\n        visit_id = visit_id_storage[\"visit_id\"]  # Берем ID визита\n    \n        assert visit_id is not None, \"Ошибка! Визит не найден!\"\n    \n        headers = {\n            \"accept\": \"application/json, text/plain, */*\",\n            \"content-type\": \"application/json\",\n            \"x-access-token\": access_token,\n            \"x-refresh-token\": refresh_token,\n            \"x-version\": \"1001\"\n        }\n        start_date = datetime.utcnow().isoformat() + \"Z\"\n        end_date = (datetime.utcnow() + timedelta(minutes=15)).isoformat() + \"Z\"\n    \n        update_data = {\n            \"type\": \"doctor\",\n            \"startDate\": start_date,\n            \"endDate\": end_date,\n            \"report\": {\n                \"channelType\": \"Индивидуальный визит\",\n                \"visitTarget\": \"Знакомство\",\n                \"presentedProductsIds\": [44, 56, 57]\n            },\n            \"status\": \"REPORTED\",\n            \"doctorIds\": [\"7b0f8e1b-54f6-4282-954e-13512bde8a05\"],\n            \"medInstitutionId\": 654247\n        }\n    \n        with allure.step(\"Отправляем запрос на завершение визита\"):\n            response = requests.patch(f\"{BASE_URL}/visits_next/doctor/{visit_id}\", headers=headers, json=update_data)\n        with allure.step(\"Верный код ответа\"):\n            assert response.status_code == 200, \"Ошибка! Визит не завершен!\"\n        with allure.step(\"Статус визита - проведен!\"):\n            response_json = response.json()\n>           assert response_json[\"data\"][\"status\"] == \"COMPLETE\", \"Ошибка! Статус визита не изменился!\"\nE           AssertionError: Ошибка! Статус визита не изменился!\nE           assert 'REPORTED' == 'COMPLETE'\nE             \nE             - COMPLETE\nE             + REPORTED\n\nstage/danone/visits/test_visit_3_reported.py:46: AssertionError"}, "description": "Обновление визита до COMPLETED", "steps": [{"name": "Отправляем запрос на завершение визита", "status": "passed", "start": 1741273536626, "stop": 1741273537389}, {"name": "Верный код ответа", "status": "passed", "start": 1741273537389, "stop": 1741273537389}, {"name": "Статус визита - проведен!", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка! Статус визита не изменился!\nassert 'REPORTED' == 'COMPLETE'\n  \n  - COMPLETE\n  + REPORTED\n", "trace": "  File \"/Users/mihailneronov/PycharmProjects/API_V2/stage/danone/visits/test_visit_3_reported.py\", line 46, in test_update_visit\n    assert response_json[\"data\"][\"status\"] == \"COMPLETE\", \"Ошибка! Статус визита не изменился!\"\n"}, "start": 1741273537389, "stop": 1741273537390}], "start": 1741273536626, "stop": 1741273537392, "uuid": "80cf04f0-7da2-43b2-92bf-b8101439a305", "historyId": "3135f2f5594be2f51290462eaa0526f7", "testCaseId": "3135f2f5594be2f51290462eaa0526f7", "fullName": "stage.danone.visits.test_visit_3_reported#test_update_visit", "labels": [{"name": "parentSuite", "value": "stage.danone.visits"}, {"name": "suite", "value": "test_visit_3_reported"}, {"name": "host", "value": "MacBook-Pro.local"}, {"name": "thread", "value": "31853-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "stage.danone.visits.test_visit_3_reported"}]}